---
timeout: 120

tasks:
  - name: Register caller
    use: register_caller

  - name: Register callee
    use: register_callee
  
  - name: Disable ACL callee
    use: disable_callee
    require:
      after:
        task: Register callee
        wait: 1

  - name: Caller UAC
    use: caller_uac
    require:
      - after:
          task: Disable ACL callee
  
  - name: Callee UAS
    use: callee_uas
    require:
      - after:
          task: Disable ACL callee
      - started:
          task: Caller UAC
  
  - name: Fail caller UAC
    use: caller_uac
    config_file: scripts/caller-fail.xml
    require:
      - after:
          task: Register callee
          wait: 70
  
  - name: Enable ACL callee
    use: enable_callee
    require:
      after:
        task: Fail caller UAC
        wait: 1

cleanup_tasks:
  - use: delete_caller_aor
  - use: delete_callee_aor
